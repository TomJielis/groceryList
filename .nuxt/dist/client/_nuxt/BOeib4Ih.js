import{f as $,r as k,c as r,o as a,v as M,a as o,x as R,i as v,C as q,B as D,g as z,j as G,D as O,F as T,h as W,b as Y,t as b,m as g,A as x}from"./B1RyEDXr.js";import{a as S,u as A}from"./BhRo35As.js";const H={class:"mt-6 max-w-md mx-auto px-4"},J=$({__name:"ListForm",emits:["list-added"],setup(E,{emit:p}){const m=S(),{showNotification:u}=D(),n=p,{createList:y}=A();let i=k("");async function w(){y(i.value.trim()).then(l=>{m.addList(l.data),i.value="",n("list-added")}).catch(l=>{console.log(l),u(l)})}return(l,f)=>(a(),r("div",H,[M(o("input",{type:"text","onUpdate:modelValue":f[0]||(f[0]=d=>q(i)?i.value=d:i=d),placeholder:"Enter new list",class:"w-full mb-3 px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 text-base"},null,512),[[R,v(i)]]),o("button",{class:"w-full py-3 rounded-xl bg-blue-500 text-white font-semibold text-base shadow-md hover:bg-blue-600 active:scale-[0.98] transition",onClick:w}," ➕ Create List ")]))}}),K={class:"max-w-screen-xl p-4"},P={key:0},Q={class:"space-y-3"},X=["onClick"],Z={class:"text-base font-medium break-words whitespace-normal"},I=["onClick"],ee={class:"relative ml-2"},te=["onClick"],se={key:0,class:"dropdown-menu absolute right-0 top-12 z-20 w-40 bg-white border rounded-xl shadow-lg"},oe=["onClick"],ne=["onClick"],ie=["onClick"],re={key:1},ce=$({__name:"lists",async setup(E){let p,m;const u=S();[p,m]=z(()=>u.fetchLists()),await p,m();const n=G(),y=A(),{favorite:i,shareList:w,deleteList:l}=y,{showNotification:f}=D(),d=k(!1),h=k(null);function F(){d.value=!1}function N(t){h.value=h.value===t?null:t}function L(t){const s=document.querySelectorAll(".dropdown-menu");let e=!1;s.forEach(c=>{c.contains(t.target)&&(e=!0)}),e||(h.value=null)}O(h,t=>{t!==null?document.addEventListener("click",L):document.removeEventListener("click",L)});async function j(t){confirm("Are you sure you want to delete this list?")&&l(t).then(async()=>{u.removeList(t)}).catch(s=>{f(s)})}function B(t){const s=prompt("Enter email to share the list with:");s&&w(t,s).then(()=>alert("List shared!"))}function V(t){i(t).then(s=>{i(t),alert("List favorited!")}).catch(s=>{f(s)})}function U(t){var c;let s=((c=n==null?void 0:n.user)==null?void 0:c.favorite_list_id)==t?null:t;V(s);const e=n.user;e&&(e.favorite_list_id=s,n.setUser(e))}return(t,s)=>(a(),r("div",K,[s[1]||(s[1]=o("h1",{class:"text-xl font-bold mb-4 text-center"},"📋 Your grocery lists",-1)),d.value?(a(),r("div",re,[Y(J,{onListAdded:F})])):(a(),r("div",P,[o("ul",Q,[(a(!0),r(T,null,W(v(u).lists,e=>{var c,C;return a(),r("li",{key:e.id,class:"flex items-center justify-between bg-white rounded-xl shadow-sm p-3 active:shadow-md transition relative"},[o("div",{class:"flex-1 cursor-pointer",onClick:_=>t.$router.push(`/list/${e.id}`)},[o("span",Z,b(e.name),1)],8,X),o("div",{class:"ml-3 text-xs font-medium bg-green-100 text-green-700 px-3 py-1 rounded-full",onClick:_=>t.$router.push(`/list/${e.id}`)},b(e.grocery_list_items_checked_count??0)+"/"+b(e.grocery_list_items_count??0),9,I),o("div",ee,[o("button",{class:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-gray-100 text-gray-600 active:bg-gray-200",onClick:x(_=>N(e.id),["stop"])}," ⋮ ",8,te),h.value===e.id?(a(),r("div",se,[o("button",{class:"block w-full text-left px-4 py-3 hover:bg-gray-100",onClick:x(_=>U(e.id),["stop"])},b(((C=(c=v(n))==null?void 0:c.user)==null?void 0:C.favorite_list_id)===e.id?"❌ Remove favorite":"⭐ Favorite"),9,oe),e.created_by==v(n).user.id?(a(),r("button",{key:0,class:"block w-full text-left px-4 py-3 hover:bg-gray-100",onClick:x(_=>B(e.id),["stop"])}," 👥 Share ",8,ne)):g("",!0),e.created_by==v(n).user.id?(a(),r("button",{key:1,class:"block w-full text-left px-4 py-3 text-red-600 hover:bg-red-100",onClick:x(_=>j(e.id),["stop"])}," 🗑️ Delete ",8,ie)):g("",!0)])):g("",!0)])])}),128))]),o("button",{class:"fixed bottom-6 right-6 bg-blue-500 text-white w-14 h-14 flex items-center justify-center rounded-full shadow-lg hover:bg-blue-600 active:scale-95 transition",style:{"padding-bottom":"env(safe-area-inset-bottom)"},onClick:s[0]||(s[0]=e=>d.value=!0)}," ➕ ")]))]))}});export{ce as default};
