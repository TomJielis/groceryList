{"version":3,"file":"lists-cNYkSfJM.js","sources":["../../../../components/list/ListForm.vue","../../../../pages/list/lists.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport {ref, defineEmits} from \"vue\";\nimport {useGroceryList} from \"~/composables/useGroceryList\";\nimport {useNotification} from \"~/composables/useNotification\";\nimport {useListStore} from \"~/stores/lists\";\n\nconst listStore = useListStore();\nconst {showNotification} = useNotification();\nconst emit = defineEmits(['list-added']);\nconst { createList } = useGroceryList();\n\nlet newList = ref('');\n\nasync function addList() {\n  createList(newList.value.trim())\n      .then((data) => {\n        listStore.addList(data.data);\n        newList.value = '';\n        emit('list-added');\n      })\n      .catch((error) => {\n        console.log(error);\n        showNotification(error);\n      });\n}\n</script>\n<template>\n  <div class=\"mt-6 max-w-md mx-auto px-4\">\n    <input\n        type=\"text\"\n        v-model=\"newList\"\n        placeholder=\"Enter new list\"\n        class=\"w-full mb-3 px-4 py-3 rounded-xl border border-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-blue-400 text-base\"\n    />\n    <button\n        class=\"w-full py-3 rounded-xl bg-blue-500 text-white font-semibold text-base shadow-md hover:bg-blue-600 active:scale-[0.98] transition\"\n        @click=\"addList\"\n    >\n      ‚ûï Create List\n    </button>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { useGroceryList } from '~/composables/useGroceryList'\nimport ListForm from '~/components/list/ListForm.vue'\nimport { ref, onMounted, onBeforeUnmount, watch } from 'vue'\nimport { useAuthStore} from \"~/stores/auth\";\nimport {useNotification} from \"~/composables/useNotification\";\nimport {useListStore} from \"~/stores/lists\";\n\nconst listStore = useListStore();\nawait listStore.fetchLists()\n\ndefinePageMeta({\n  middleware: 'auth',\n})\n\nconst auth = useAuthStore()\nconst list = useGroceryList()\nconst { favorite, shareList, deleteList } = list // assuming these methods exist\nconst {showNotification} = useNotification();\n\nconst openListForm = ref(false)\nconst openDropdown = ref<number | null>(null)\n\nfunction handleList() {\n  openListForm.value = false\n}\n\nfunction toggleDropdown(id: number) {\n  openDropdown.value = openDropdown.value === id ? null : id\n}\n\n// Close dropdown if click happens outside\nfunction handleClickOutside(event: MouseEvent) {\n  const dropdowns = document.querySelectorAll('.dropdown-menu')\n  let clickedInside = false\n  dropdowns.forEach((dropdown) => {\n    if (dropdown.contains(event.target as Node)) clickedInside = true\n  })\n  if (!clickedInside) openDropdown.value = null\n}\n\nwatch(openDropdown, (val) => {\n  if (val !== null) {\n    document.addEventListener('click', handleClickOutside)\n  } else {\n    document.removeEventListener('click', handleClickOutside)\n  }\n})\n\n\nasync function confirmDelete(id: number) {\n  if (confirm('Are you sure you want to delete this list?')) {\n    deleteList(id).then(async () => {\n      listStore.removeList(id);\n    }).catch((error) => {\n      showNotification(error);\n    });\n  }\n}\n\nfunction shareListWithUser(id: number) {\n  // You might want to show a modal here\n  const email = prompt('Enter email to share the list with:')\n  if (email) {\n    shareList(id, email).then(() => alert('List shared!'))\n  }\n}\n\nfunction makefavorite(id: number| null) {\n  favorite(id)\n      .then((data) => {\n        favorite(id);\n        alert(`List favorited!`)\n      })\n      .catch((error) => {\n        showNotification(error);\n      });\n}\n\nfunction setFavoriteList(id: number) {\n  let listId = auth?.user?.favorite_list_id == id ? null : id;\n  makefavorite(listId)\n  const data = auth.user;\n  if(data){\n    data.favorite_list_id = listId;\n    auth.setUser(data);\n  }\n}\n\n</script>\n\n\n<template>\n  <div class=\"max-w-screen-xl p-4\">\n    <h1 class=\"text-xl font-bold mb-4 text-center\">üìã Your grocery lists</h1>\n\n    <div v-if=\"!openListForm\">\n      <ul class=\"space-y-3\">\n        <li\n            v-for=\"listItem in listStore.lists\"\n            :key=\"listItem.id\"\n            class=\"flex items-center justify-between bg-white rounded-xl shadow-sm p-3 active:shadow-md transition relative\"\n        >\n          <div class=\"flex-1 cursor-pointer\" @click=\"$router.push(`/list/${listItem.id}`)\">\n            <span class=\"text-base font-medium break-words whitespace-normal\">{{ listItem.name }}</span>\n          </div>\n          <div\n              class=\"ml-3 text-xs font-medium bg-green-100 text-green-700 px-3 py-1 rounded-full\"\n              @click=\"$router.push(`/list/${listItem.id}`)\"\n          >\n            {{ listItem.grocery_list_items_checked_count ?? 0 }}/{{ listItem.grocery_list_items_count ?? 0}}\n          </div>\n          <div class=\"relative ml-2\">\n            <button\n                class=\"w-10 h-10 flex items-center justify-center rounded-full hover:bg-gray-100 text-gray-600 active:bg-gray-200\"\n                @click.stop=\"toggleDropdown(listItem.id)\"\n            >\n              ‚ãÆ\n            </button>\n\n            <div\n                v-if=\"openDropdown === listItem.id\"\n                class=\"dropdown-menu absolute right-0 top-12 z-20 w-40 bg-white border rounded-xl shadow-lg\"\n            >\n              <button\n                  class=\"block w-full text-left px-4 py-3 hover:bg-gray-100\"\n                  @click.stop=\"setFavoriteList(listItem.id)\"\n              >\n                {{auth?.user?.favorite_list_id === listItem.id  ? '‚ùå Remove favorite' : '‚≠ê Favorite'}}\n              </button>\n              <button\n                  v-if=\"listItem.created_by == auth.user.id\"\n                  class=\"block w-full text-left px-4 py-3 hover:bg-gray-100\"\n                  @click.stop=\"shareListWithUser(listItem.id)\"\n              >\n                üë• Share\n              </button>\n              <button\n                  v-if=\"listItem.created_by == auth.user.id\"\n                  class=\"block w-full text-left px-4 py-3 text-red-600 hover:bg-red-100\"\n                  @click.stop=\"confirmDelete(listItem.id)\"\n              >\n                üóëÔ∏è Delete\n              </button>\n            </div>\n          </div>\n        </li>\n      </ul>\n      <button\n          class=\"fixed bottom-6 right-6 bg-blue-500 text-white w-14 h-14 flex items-center justify-center rounded-full shadow-lg hover:bg-blue-600 active:scale-95 transition\"\n          style=\"padding-bottom: env(safe-area-inset-bottom)\"\n          @click=\"openListForm = true\"\n      >\n        ‚ûï\n      </button>\n    </div>\n\n    <div v-else>\n      <ListForm @list-added=\"handleList\" />\n    </div>\n  </div>\n</template>\n"],"names":["_ssrRenderAttrs","_mergeProps","_unref","_withAsyncContext","_ssrInterpolate","_ssrRenderComponent","ListForm"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAMkB,iBAAA;AAGK,mBAAA;AAEvB,QAAI,UAAU,IAAI,EAAE;;mBAgBbA,eAAAC,WAAA,EAAA,OAAM,gCAA4B,MAAA,CAAA,8CAGxBC,MAAA,OAAA,CAAO;;;;;;;;;;;;;;;ACtBxB,UAAM,YAAY,aAAA;AAClB,KAAA,QAAA,SAAA,IAAAC,iBAAA,MAAM,UAAU,YAAW;AAM3B,UAAM,OAAO,aAAA;AACA,mBAAA;AAIb,UAAM,eAAe,IAAI,KAAK;AAC9B,UAAM,eAAe,IAAmB,IAAI;AAE5C,aAAS,aAAa;AACpB,mBAAa,QAAQ;AAAA,IACvB;AAOA,aAAS,mBAAmB,OAAmB;AAC7C,YAAM,YAAY,SAAS,iBAAiB,gBAAgB;AAC5D,UAAI,gBAAgB;AACpB,gBAAU,QAAQ,CAAC,aAAa;AAC9B,YAAI,SAAS,SAAS,MAAM,MAAc,EAAG,iBAAgB;AAAA,MAC/D,CAAC;AACD,UAAI,CAAC,cAAe,cAAa,QAAQ;AAAA,IAC3C;AAEA,UAAM,cAAc,CAAC,QAAQ;AAC3B,UAAI,QAAQ,MAAM;AAChB,QAAA,SAAS,iBAAiB,SAAS,kBAAkB;AAAA,MACvD,OAAO;AACL,QAAA,SAAS,oBAAoB,SAAS,kBAAkB;AAAA,MAC1D;AAAA,IACF,CAAC;;AA8CM,YAAA,OAAAH,eAAAC,WAAA,EAAA,OAAM,yBAAqB,MAAA,CAAA,CAAA,4EAAA;WAGlB,aAAA,OAAY;;sBAGGC,MAAA,SAAA,EAAU,OAAK,CAA3B,aAAQ;;6OAKsDE,eAAA,SAAS,IAAI,0GAM/EA,eAAA,SAAS,oCAAgC,CAAA,KAAYA,eAAA,SAAS,4BAAwB,CAAA;cAW/E,aAAA,UAAiB,SAAS,IAAE;AAOhC,kBAAA,wKAAAA,iBAAAF,iBAAA,IAAA,MAAAA,mBAAM,SAANA,mBAAY,sBAAqB,SAAS,KAAE,sBAAA,YAAA,CAAA,WAAA;AAGtC,gBAAA,SAAS,cAAcA,YAAK,KAAK,IAAE;;;;;AAOnC,gBAAA,SAAS,cAAcA,YAAK,KAAK,IAAE;;;;;;;;;;;iOAYjD,EAAA,kBAAA,8BAAA,CAAmD,CAAA,sBAAA;AAAA;;AAQ5C,cAAAG,mBAAAC,aAAA,EAAA,aAAY,cAAU,MAAA,OAAA,CAAA;;;;;;;;;;;;;"}